{% extends 'layout/base.html' %}

{% block style %}
  <link href="/static/css/d3js.css" rel="stylesheet" media="screen">
  <link href="/static/css/clustering.css" rel="stylesheet" media="screen">
{% endblock %}

{% block container %}
<div class="row">
  <div class="col-md-12">
    <h2>
      DGA Clustering
      <hr>
    </h2>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <svg id="clusters-vis"></svg>
  </div>
  <div class="col-md-6">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">Dashboard</h3>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-md-12">
              <label for="select-cluster">Select a cluster</label>
              <select name="select-cluster" id="select-cluster" class="form-control">
                <option value="none">none</option>
              </select>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <label for="xaxis">X Axis Domain</label>
              <select name="xaxis" id="xaxis" class="form-control">
                <option value="one_gram" selected="selected">One Gram</option>
                <option value="two_gram">Two Gram</option>
                <option value="three_gram">Three Gram</option>
                <option value="meaningful_word_ratio">Meaningful Word Ratio</option>
              </select>
            </div>
            <div class="col-md-6">
              <label for="yaxis">Y Axis Domain</label>
              <select name="yaxis" id="yaxis" class="form-control">
                <option value="one_gram">One Gram</option>
                <option value="two_gram" selected="selected">Two Gram</option>
                <option value="three_gram">Three Gram</option>
                <option value="meaningful_word_ratio">Meaningful Word Ratio</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <div class="panel panel-info" id="map-panel">
        <div class="panel-heading">
          <h3 class="panel-title">Map</h3>
        </div>
        <div class="panel-body">
          <div id="map-canvas-clustering"></div>
        </div>
      </div>
    </div>
  </div>
<div class="row">
  <div class="col-md-12">
    <h2>Explanation</h2>
    <hr>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    This step receives as input the set of domains $d \in D$ that have passed Step 1. These domains are such that $d_{Mah}(f(d)) > \Lambda$, which means that (beside being malicious) are likely to be automatically generated, because they are too far from the centroid of the HGDs.
    Our goal is to cluster domains according to their similarity,    
  </div>
  <div class="col-md-6">
    where we define as similar two domains that resolved to similar sets of IP addresses. The rationale is that the botmaster of a DGA-based botnet registers several domains that, at different points in time, resolve to the same set of IPs (i.e., the C&ampC servers). These are the domains that we wish to group together.   
  </div>
</div>

<div class="row">
  <hr>
  <div class="col-md-6">
    <h3>Bipartite Graph Recursive Clustering</h3>
    <p>
      This step receives as input the set of domains $d \in D$ that have passed 
      <a href="/filtering">Step 1</a>. These domains are such that $d_{Mah}(f(d)) > \Lambda$, which 
      means that (beside being malicious) are likely to be automatically 
      generated, because they are too far from the centroid of the HGDs.<br>
      To cluster the domain nodes D, we hierarchically apply the DBSCAN clustering 
      algorithm, which is particularly fast and easy to implement in our 
      scenario.
      We represent the domain-to-ip relations as a bipartite graph where two sets of node exist: 
      $K = |D|$ nodes represent the domains, and $L = | IPs(D)|$ nodes represent the IPs. An edge exists from a node $d \in D$ to node $l \in IPs(D)$ whenever domain $d$ pointed to IP $l$.
      We encode the bipartite graph as a sparse matrix $M \in
      RL \times K$ with $L$ rows and $K$ columns. Each cell $M_{l,k}$ holds the weight of an
      edge $k \rightarrow l$ in the bipartite graph, which represents the fact that domain $d_k$
      resolves to IP $l$. The weight encodes the “importance” of this relation. For
      each IP $l$ in the graph, the weights $M_{l,k},\forall k = 1,\ldots,K$ are set to  1 , where $|D(l)|$
      $D(l) \subset D$ is the subset of domains that point to that IP. This weight encodes the peculiarity of each IP: The less domains an IP is pointed by, the more characterizing it is.
    </p>
  </div>
  <div class="col-md-6">
    <img src="/static/images/phoenix_clustering.png" alt="Clustering" class="img-rounded full-width" id="img-clustering">
  </div>
</div>
{% endblock %}

{% block scripts %}
  <script src="/static/js/d3.v3.min.js" charset="utf-8"></script>
  <script src="/static/js/radar-chart.js"></script>
  <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjLu93p4ouLPm4CeQP9tTDR6hVbe7qjkc&sensor=false"></script>
  <script src="/static/js/clustering.js"></script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
  </script>
  <script type="text/javascript" src="/static/js/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
{% endblock %}